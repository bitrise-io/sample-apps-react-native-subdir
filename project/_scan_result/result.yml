options:
  react-native:
    title: Path to the gradle file to use
    env_key: GRADLE_BUILD_FILE_PATH
    value_map:
      android/build.gradle:
        title: Gradlew file path
        env_key: GRADLEW_PATH
        value_map:
          android/gradlew:
            title: Project (or Workspace) path
            env_key: BITRISE_PROJECT_PATH
            value_map:
              ios/SampleAppsReactNativeAndroid.xcodeproj:
                title: Scheme name
                env_key: BITRISE_SCHEME
                value_map:
                  SampleAppsReactNativeAndroid:
                    config: reactnative-android-ios-test-config
                  SampleAppsReactNativeAndroid-tvOS:
                    config: reactnative-android-ios-test-config
configs:
  react-native:
    reactnative-android-ios-test-config: |
      format_version: "3"
      default_step_lib_source: https://github.com/bitrise-io/bitrise-steplib.git
      project_type: react-native
      trigger_map:
      - push_branch: '*'
        workflow: primary
      - pull_request_source_branch: '*'
        workflow: primary
      workflows:
        deploy:
          steps:
          - activate-ssh-key@3.1.1:
              run_if: '{{getenv "SSH_RSA_PRIVATE_KEY" | ne ""}}'
          - git-clone@3.5.0: {}
          - script@1.1.4:
              title: Do anything with Script step
          - install-react-native@0.9.1: {}
          - npm@0.9.0:
              inputs:
              - command: install
          - install-missing-android-tools@1.0.3: {}
          - gradle-runner@1.7.1:
              inputs:
              - gradle_file: $GRADLE_BUILD_FILE_PATH
              - gradle_task: assembleRelease
              - gradlew_path: $GRADLEW_PATH
          - certificate-and-profile-installer@1.8.6: {}
          - xcode-archive@2.0.6:
              inputs:
              - project_path: $BITRISE_PROJECT_PATH
              - scheme: $BITRISE_SCHEME
              - configuration: release
          - deploy-to-bitrise-io@1.3.5: {}
        primary:
          steps:
          - activate-ssh-key@3.1.1:
              run_if: '{{getenv "SSH_RSA_PRIVATE_KEY" | ne ""}}'
          - git-clone@3.5.0: {}
          - script@1.1.4:
              title: Do anything with Script step
          - install-react-native@0.9.1: {}
          - npm@0.9.0:
              inputs:
              - command: install
          - npm@0.9.0:
              inputs:
              - command: test
          - deploy-to-bitrise-io@1.3.5: {}
warnings:
  react-native: []
